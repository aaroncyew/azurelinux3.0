# generic + compressed please
hostonly="no"
compress="xz"

# VMs can't update microcode anyway
early_microcode="no"

# modules: basics
dracutmodules+=" base systemd systemd-initrd dracut-systemd dbus usrmount shutdown i18n "

# modules: storage support
dracutmodules+=" dm rootfs-block fs-lib "

# modules: tpm and crypto
dracutmodules+=" crypt crypt-loop tpm2-tss "

# modules: support root on virtiofs
dracutmodules+=" virtiofs "

# modules: use sysext images (see 'man systemd-sysext')
dracutmodules+=" systemd-sysext "

# modules: coal modules. repart for partition typing and read-only rootfs. tmpfiles for spawning missing overlay dirs
add_dracutmodules+=" systemd-repart systemd-tmpfiles "

# drivers: virtual buses, pci
drivers+=" virtio-pci virtio-mmio "      # qemu-kvm
drivers+=" hv-vmbus pci-hyperv "         # hyperv
drivers+=" xen-pcifront "                # xen

# drivers: storage
drivers+=" ahci nvme sd_mod sr_mod "     # generic
drivers+=" virtio-blk virtio-scsi "      # qemu-kvm
drivers+=" hv-storvsc "                  # hyperv
drivers+=" xen-blkfront "                # xen

# coal
drivers+=" overlay "

# filesystems
filesystems+=" vfat ext4 xfs overlay "
